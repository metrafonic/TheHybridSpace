<!DOCTYPE html>


<html>
<title>The Hybrid Space</title>

<head>
    <script src="/javascripts/highcharts.js"></script>
    <script src="/javascripts/urltools.js"></script>
    <script type="text/javascript" src="/javascripts/jquery.min.js"></script>

    <style>
        #container {
            min-width: 580px;
            height: 600px;
            max-width: 580px;
            margin: 0 auto
        }
    </style>
</head>

<body>
    <div id="container"></div>

    <script>
        completedata = [];

        function updateData() {
            $.when(
                $.getJSON('/api/person/' + getUrlParameter('id')),
                $.getJSON('/api/evaluations/' + getUrlParameter('id'))
            ).done(function(a, b) {
                try {
                    parseData(b[0]);
                } catch (err) {
                    console.log(err.message);
                }


            });
        }

        function parseData(data) {
            //console.log(data.data);
            var jsondata = new Object();
            jsondata.name = "All data";
            jsondata.color = 'rgba(223, 83, 83, .5)';

            plotdata = [];
            i = 0;
            $.each(data.data, function(key, value) {
                //console.log(value.x, i);
                plotdata[i] = [value.x, value.y];
                i++;
            });


            jsondata.data = plotdata;

            completedata[0] = jsondata;
            showGraph(plotdata);
            //console.log(plotdata);
        }


        function showGraph(data) {



            var options = {

                plotOptions: {
                    scatter: {
                        animation: false,
                        lineWidth:2
                    }
                },
                chart: {
                    renderTo: 'container',
                    type: 'scatter',
                    backgroundColor: '#FFFFFF',
                    plotBackgroundImage: '/images/hybrid.jpg',

                },
                title: {
                    text: 'Data for person ' + getUrlParameter('id')
                },
                xAxis: {
                    gridLineWidth: 0,
                    tickInterval: 1,
                    lineColor: 'black',
                    zeroCrossing: false,
                    min: -250,
                    max: 250
                },
                yAxis: {
                    min: -250,
                    max: 250,
                    gridLineWidth: 0,
                    title: {
                        _text: null
                    }
                },
                series: [{}]
            };

            options.series[0].data = data;
            var chart = new Highcharts.Chart(options);


        }

        updateData();
        setInterval(updateData, 5000);
    </script>
</body>

</html>
